---
sidebar: sidebar
permalink: concept_architecture.html
keywords: cloud tiering, architecture, diagram, components, bucket, object storage, object store, service connector, policy, volume policy, volume tiering policy, tiering policy, auto
summary: Cloud Tiering is a NetApp-managed service that uses FabricPool technology to automatically tier inactive data from your on-premises ONTAP clusters to object storage in the cloud. Connections to ONTAP take place from the NetApp Service Connector.
---

= How Cloud Tiering works
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Cloud Tiering is a NetApp-managed service that uses FabricPool technology to automatically tier inactive (cold) data from your on-premises ONTAP clusters to object storage in the cloud. Connections to ONTAP take place from the NetApp Service Connector.

== Overview

The following image shows the relationship between each component:

image:diagram_cloud_tiering.png[An architecture image that shows the Cloud Tiering service with a connection to the Service Connector in your cloud provider, the Service Connector with a connection to your ONTAP cluster, and a connection between the ONTAP cluster and object storage in your cloud provider. Active data resides in the ONTAP cluster, while inactive data resides in object storage.]

At a high level, Cloud Tiering works like this:

. You deploy a NetApp Service Connector.
+
* When tiering to S3, the Service Connector can be in an AWS VPC or on your premises.
* When tiering to Blob storage, the Service Connector must be in an Azure VNet.
* When tiering to Google Cloud Storage, the Service Connector must reside in a Google Cloud Platform VPC.
. The Service Connector communicates with ONTAP clusters to discover the amount of active and inactive data on the cluster.
. You choose the volumes to tier and the tiering policy to apply to those volumes.
. You choose the object storage provider that you want to use.
. The Service Connector configures ONTAP to use that object storage provider.
. The Service Connector configures data tiering on each volume that you selected.
. ONTAP starts tiering inactive data to the object store, as soon as the data has reached the thresholds to be considered inactive (see <<Volume tiering policies>>).

== NetApp Service Connector

The Service Connector is software that communicates with ONTAP clusters to discover the amount of active and inactive data on the cluster and to set up data tiering. Cloud Tiering prompts you to deploy the Service Connector when you discover your first ONTAP cluster. Connections to ONTAP take place from the Service Connector. A single Service Connector can discover multiple ONTAP clusters.

== Object storage

Each ONTAP cluster tiers inactive data to a single object store that Cloud Tiering creates for you. Cloud Tiering prompts you to choose a cloud storage provider when you set up tiering for each cluster.

=== S3 storage classes

When you set up data tiering to AWS, you can choose the _S3 Standard_ storage class or the _Standard-Infrequent Access_ storage class. If you choose Standard-Infrequent, inactive data starts in the Standard storage class and transitions to Standard-Infrequent Access, if the data is not accessed after 30 days.

https://aws.amazon.com/s3/storage-classes/[Learn about these S3 storage classes^].

=== Azure Blob access tiers

When you set up data tiering to Azure, Cloud Tiering automatically uses the _Hot_ access tier for your inactive data. We plan to add support for the _Cool_ access tier in a future release.

=== Google Cloud storage classes

Cloud Tiering uses the _Standard_ access tier for your inactive data.

== Volume tiering policies

When you select the volumes that you want to tier, you also choose a _volume tiering policy_ to apply to each volume. A tiering policy defines the type of cold data that you want to tier from the volumes.

Cold snapshots (Snapshot only):: ONTAP tiers cold Snapshot blocks in the volume that are not shared with the active file system to object storage. If read, cold data blocks on the cloud tier become hot and are moved to the performance tier.
+
Data is tiered only after an aggregate has reached 50% capacity and when the data has reached the cooling period, which is approximately 2 days.

Cold user data (Auto):: ONTAP tiers all cold blocks in the volume (not including metadata) to object storage. The cold data includes not just Snapshot copies but also cold user data from the active file system.
+
If read by random reads, cold data blocks on the cloud tier become hot and are moved to the performance tier. If read by sequential reads, such as those associated with index and antivirus scans, cold data blocks on the cloud tier stay cold and are not written to the performance tier.
+
Data is tiered only after an aggregate has reached 50% capacity and when the data has reached the cooling period, which is approximately 31 days. The cooling period is the time that user data in a volume must remain inactive for the data to be considered "cold" and moved to the object store.

All user data (All):: All data (not including metadata) is _immediately_ moved to the cloud tier. If read, cold data blocks on the cloud tier stay cold and are not written back to the performance tier.
